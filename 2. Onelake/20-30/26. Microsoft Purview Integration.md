Of course. Here is the detailed, long-form study note for topic #23.

---

# Topic 23: Microsoft Purview Integration

*   The integration between Microsoft Fabric and **Microsoft Purview** is a critical component of the platform's governance and compliance story. Microsoft Purview is a family of unified data governance solutions that help organizations manage and govern their entire data estate, whether it's on-premises, in Azure, or in other clouds.
*   For OneLake, this integration is not an afterthought; it is built into the fabric of the platform. It elevates OneLake from being just a storage location to a fully governable, auditable, and discoverable data lake. The integration addresses key governance needs, including **data discovery and cataloging, end-to-end data lineage, and information protection**.
*   This seamless connection allows organizations to have a single pane of glass for data governance, applying a consistent set of policies and gaining a holistic understanding of their data, from its raw source in OneLake to its final consumption in a Power BI report.

> [!IMPORTANT]
> The Purview integration story for Fabric has two main parts:
> 1.  **"Inside" Fabric (Built-in Hubs):** Features like the OneLake Data Hub and Lineage View, which are natively integrated and provide immediate value within the Fabric experience.
> 2.  **"Outside" Fabric (The Full Purview Portal):** Connecting your Fabric tenant to a full Microsoft Purview account in Azure to unlock advanced, enterprise-wide governance capabilities like a comprehensive data catalog, automated scanning, and glossary terms.

## **Core Components of the Integration**

### **1. The OneLake Data Hub (Data Discovery)**

*   **What it is:** The OneLake Data Hub is a built-in, user-friendly data marketplace or storefront directly within the Fabric UI.
*   **Purview's Role:** While it's a Fabric feature, it's powered by Purview's cataloging principles. It automatically indexes all shareable data items (Lakehouses, Warehouses, Semantic Models, etc.) across the entire Fabric tenant.
*   **Functionality:**
    *   **Search and Filter:** Users can search for data by keyword or filter by domain, creator, or other metadata.
    *   **Endorsement and Certification:** The hub prominently displays the endorsement status (Promoted or Certified) of data assets. This is a direct signal of trust and quality, managed by data owners and governed by Purview principles.
    *   **Discoverability:** It allows data consumers to easily find and request access to authoritative data products, fulfilling a key tenet of the "Data as a Product" principle in a data mesh.

### **2. End-to-End Data Lineage**

*   **What it is:** The ability to trace the flow of data from its origin, through all transformation steps, to its final destination in reports and dashboards.
*   **Purview's Role:** Fabric automatically captures lineage information as data moves between its various items. This information is a subset of the rich lineage graph that Purview can build.
*   **Functionality (The Lineage View):**
    *   From any workspace, you can switch to the **Lineage View**. This provides a graphical, interactive diagram.
    *   **Visualization:** It shows, for example, that a Dataflow Gen2 ingests data from an external source, loads it into a Lakehouse table, which is then consumed by a Power BI semantic model, which in turn feeds three different reports.
    *   **Impact Analysis:** This is a critical governance and operational tool. Before changing a table in a Lakehouse, a developer can use the lineage view to see exactly which downstream reports and models will be impacted by the change, preventing accidental breakages.
    *   **Root Cause Analysis:** When a report shows incorrect data, an analyst can use the lineage view to trace the data's path backward to identify the potential source of the error.

### **3. Information Protection (Sensitivity Labels)**

*   **What it is:** The ability to classify data based on its sensitivity (e.g., General, Confidential, Highly Confidential - PII) and have that classification persist and be enforced throughout its lifecycle.
*   **Purview's Role:** This feature is a direct integration with **Microsoft Purview Information Protection** (formerly Microsoft Information Protection or MIP). The sensitivity labels are defined centrally in the Microsoft 365 Compliance Center.
*   **Functionality:**
    *   **Inheritance:** This is the key capability. If a data owner applies a "Highly Confidential" label to a table in a Fabric Warehouse:
        *   When a new Power BI semantic model is created on top of that Warehouse, it will **automatically inherit** the "Highly Confidential" label.
        *   When a user then exports data from a report built on that model to an Excel or PowerPoint file, that exported file will **also automatically inherit** the label.
    *   **Downstream Enforcement:** Once a file is labeled, organizational policies can be applied. For example, a Data Loss Prevention (DLP) policy could block any email that has an attachment with the "Highly Confidential" label from being sent to an external recipient.
    *   **Domain-level Defaults:** Fabric Admins can set default sensitivity labels for domains, helping to enforce consistent classification for entire business areas.

## **Advanced Integration with the Microsoft Purview Data Catalog**

*   While the built-in features are powerful, connecting your Fabric tenant to a full Purview account in Azure unlocks the next level of enterprise governance.

*   **### Automated Scanning**
    *   You can register your entire Fabric tenant as a data source in the Purview Data Map.
    *   Purview can then perform a deep, automated **scan** of your entire OneLake. This scan goes beyond what the Data Hub shows.
    *   It inventories every single item, extracts detailed schema metadata, and can even apply **automated classification rules** to detect sensitive data (e.g., finding columns that contain credit card numbers or national ID numbers and automatically tagging them as PII).

*   **### Business Glossary**
    *   The full Purview portal allows you to create and manage a **Business Glossary**.
    *   This allows you to define official business terms (e.g., "Active Customer," "Gross Revenue") and link them to the physical data assets in Fabric. When a user is browsing the catalog, they can see the official business definition associated with a table or column, which greatly improves clarity and trust.

*   **### Holistic, Cross-Estate View**
    *   The biggest benefit is a single catalog for your **entire** data estate. A user searching in the Purview portal can see that the `DimCustomer` table in a Fabric Lakehouse is derived from a `customers` table in an on-premises SQL Server, which is also used by an Azure Data Factory pipeline. It provides the complete picture that is not limited to just the Fabric environment.

## **Use Cases and Scenarios**

*   **### GDPR and Compliance Audits**
    *   **Scenario:** A company is undergoing a GDPR audit and needs to prove where all of its customer PII data is stored and who has access to it.
    *   **Implementation:** By using Purview's automated scanning and classification, the company has a near-real-time inventory of all data assets tagged as "PII." Using the **lineage view**, they can show auditors the exact journey of that data, demonstrating that it is handled correctly. **Sensitivity labels** ensure that any exported data remains protected.

*   **### Self-Service Analytics with Confidence**
    *   **Scenario:** A business analyst in the marketing department needs to find the authoritative source for customer information.
    *   **Implementation:** They go to the OneLake Data Hub. They filter by the "Customer" domain and see two semantic models: `Customer_Analysis_v2_Test` and `Certified_Customer_Model`. The **certification badge**, a Purview-driven concept, immediately tells them which one to use. They can then view the **lineage** for this model to see that it comes from the curated Gold Lakehouse, further increasing their confidence.

*   **### Change Management and Impact Analysis**
    *   **Scenario:** A data engineering team needs to change the data type of the `Region` column in their main `FactSales` table from `string` to `integer`.
    *   **Implementation:** Before making the change, they open the **lineage view** for the `FactSales` table. They instantly see that this table is a source for 15 different Power BI semantic models and 2 other dataflows. They realize this change would break all of them. They can then proactively communicate with the owners of those downstream assets to coordinate the change, preventing a major outage.

## **Common Pitfalls / Mistakes**

*   **Mistake 1: Ignoring Endorsements.**
    *   **Pitfall:** An organization doesn't establish a process for promoting or certifying datasets. The Data Hub becomes a swamp of similarly named items, and users don't know which one to trust, defeating the purpose of discovery.
    *   **Correction:** Create a clear governance policy for endorsements. Define who can certify data (usually a domain owner or a central governance body) and what criteria must be met (e.g., has documentation, meets quality standards, has a designated owner).

*   **Mistake 2: Relying Only on Manual Labeling.**
    *   **Pitfall:** An organization relies on its developers to manually apply sensitivity labels to all data. This process is inconsistent and error-prone, and sensitive data is often left unlabeled.
    *   **Correction:** Leverage the full power of Purview's **automated scanning and classification**. Define rules that can automatically detect patterns (like credit cards, emails, etc.) and apply the correct labels. This provides a much more reliable and comprehensive security baseline.

*   **Mistake 3: Viewing Lineage as a One-Time Report.**
    *   **Pitfall:** A team only looks at the lineage view when something breaks.
    *   **Correction:** Integrate lineage analysis into your standard development lifecycle. It should be a mandatory check-in a Change Management process. Before any change is deployed to a shared data asset, the developer should review the lineage to perform an impact analysis.

## **Flashcards (Q&A)**

*   **Q: What are the three main governance capabilities provided by the Fabric and Purview integration?**
    *   A: 1. Data Discovery/Cataloging (Data Hub), 2. End-to-End Data Lineage, 3. Information Protection (Sensitivity Labels).
*   **Q: What is the purpose of the OneLake Data Hub?**
    *   A: To act as a built-in data marketplace, allowing users to easily discover, filter, and find trusted data assets across the entire Fabric tenant.
*   **Q: What is data lineage, and why is it important?**
    *   A: It's a visual map of how data flows through the system. It's critical for impact analysis (understanding the downstream effects of a change) and root cause analysis (tracing a data error back to its source).
*   **Q: What is the key benefit of sensitivity label inheritance?**
    *   A: It ensures that a data classification applied at the source (e.g., a Warehouse table) is automatically propagated downstream to Power BI models and even to exported files like Excel, providing persistent data protection.
*   **Q: What advanced governance feature does the full Microsoft Purview portal provide that the built-in Fabric experience does not?**
    *   A: A unified, cross-estate data catalog with automated scanning/classification and a business glossary.
*   **Q: What is the difference between "Promoted" and "Certified" endorsements?**
    *   A: "Promoted" is a self-service endorsement by data owners to highlight valuable data. "Certified" is a higher level of endorsement, typically granted by a central governance body, signifying that the data is authoritative and meets stringent quality standards.
*   **Q: Can Purview automatically detect PII data in OneLake?**
    *   A: Yes, when connected to a full Purview account, you can configure automated scanning with classification rules to detect and tag sensitive data patterns.
*   **Q: How do Domains in Fabric enhance the Purview discovery experience?**
    *   A: They provide a high-level business context filter in the OneLake Data Hub, allowing users to quickly narrow down their search to a specific subject area.
*   **Q: Where are sensitivity labels (e.g., "Confidential") actually defined?**
    *   A: They are defined centrally in the Microsoft 365 Compliance Center as part of the Microsoft Purview Information Protection framework.
*   **Q: A developer wants to change a table schema. Which Purview-integrated feature should they use first?**
    *   A: The Lineage View, to perform an impact analysis on all downstream dependencies.
